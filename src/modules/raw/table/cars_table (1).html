<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8">
<head>
    <link href="hw2.css" rel="stylesheet">
    <meta charset="UTF-8">
    <title>Vroom Vroom Project</title>
</head>
<body>
<script src="https://d3js.org/d3.v3.min.js"></script>
<script>

    var sort_bool = true;

    d3.json("cars.json", function(error, data){

        var columns = Object.keys(data[0]);

        var table = d3.select("body").append("table"),
            thead = table.append("thead")
                .attr("class", "thead");
        tbody = table.append("tbody");

        table.append("caption")
            .html("Muscle Cars");

        /*
        thead.append("tr").selectAll("th")
            .data(columns)
            .enter()
            .append("th")
            .text(function(d) { return d; })
            .on("click", function(header, i) {
                tbody.selectAll("tr").sort(function(a, b) {
                    return d3.descending(a[header], b[header]);
                });
            });
            */
        //


        thead.append("tr").selectAll("th")
            .data(columns)
            .enter()
            .append("th")
            .text(function(d) { return d; })
            .on("click", function(header, i) {

                d3.select("img").remove();
                if (sort_bool) {
                    sort_bool = false;
                    d3.select(this).append('img').attr('src', '2.png');
                    d3.select(this).style("cursor", "n-resize");
                    tbody.selectAll("tr").sort(function(a, b) {
                        return d3.descending(a[header], b[header]);
                    }).style("background-color", function (d, i) {
                        if (i % 2 == 0) {
                            return "#D8D8D8";
                        }
                    });
                }
                else {
                    sort_bool = true;

                    d3.select(this).append('img').attr('src', '1.png');
                    tbody.selectAll("tr").sort(function (a, b) {
                        return d3.ascending(a[header], b[header]);
                    }).style("background-color", function (d, i) {
                        if (i % 2 == 0) {
                            return "#D8D8D8";
                        }
                    });
                }
            });


        var rows = tbody.selectAll("tr.row")
            .data(data)
            .enter()
            .append("tr").attr("class", "row")
            .style("background-color", function (d, i) {
                if (i % 2 == 0) {
                    return "#D8D8D8";
                }
            });

        var cells = rows.selectAll("td")
            .data(function(row) {
                return d3.range(Object.keys(row).length).map(function(column, i) {
                    return row[Object.keys(row)[i]];
                });
            })
            .enter()
            .append("td")
            .text(function(d) { return d; })
            .on("mouseover", function(d, i) {

                d3.select(this.parentNode)
                    .style("background-color", "#78B47F");

            })
            .on("mouseout", function() {

                tbody.selectAll("tr").style("background-color", function (d, i) {
                    if (i % 2 == 0) {
                        return "#D8D8D8";
                    }
                })
            })

        //

        /*
        var rows = tbody.selectAll("tr.row")
            .data(data)
            .enter()
            .append("tr").attr("class", "row");

        var cells = rows.selectAll("td")
            .data(function(row) {
                return d3.range(Object.keys(row).length).map(function(column, i) {
                    return row[Object.keys(row)[i]];
                });
            })
            .enter()
            .append("td")
            .text(function(d) { return d; })
            .on("mouseover", function(d, i) {

                d3.select(this.parentNode)
                    .style("background-color", "#78B47F");

            }).on("mouseout", function() {

                tbody.selectAll("tr")
                    .style("background-color", null)
                    .selectAll("td")
                    .style("background-color", null);

            });

*/
    });
</script>
</body>
</html>